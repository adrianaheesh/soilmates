<p id="notice"><%= notice %></p>

<p>
  <strong>Name:</strong>
  <%= @product.name %>
</p>

<p>
  <strong>Description:</strong>
  <%= @product.description %>
</p>

<p>
  <strong>Availability:</strong>
  <%= @product.availability %>
</p>

<p>
  <strong>Category:</strong>
  <%= @product.category %>
</p>

<p>
  <strong>Light:</strong>
  <%= @product.light %>
</p>

<p>
  <strong>Difficulty:</strong>
  <%= @product.difficulty %>
</p>

<p>
  <strong>Price:</strong>
  <%= @product.price %>
</p>

<p>
  <strong>Store:</strong>
  <%= @product.store_id %>
</p>

<p>
  <%= link_to "Buy Now", buy_path, method: :post %>
</p>
<script src="https://js.stripe.com/v3/"></script>

<script>
	const stripe = Stripe('<%= ENV["STRIPE_PUBLICKEY"] %>')
	const buyButton = document.getElementById('buy-now-button')

	buyButton.addEventListener('click', function() {
		fetch('<%= buy_path(@product.id) %>'), { 
			method: 'POST'
		})
		.then(function(response) {
			return response.json()
		})
		.then(function(session) {
			return stripe.redirectToCheckout({ sessionId: session.id })
		}) 
	})
</script>

<%= link_to 'Edit', edit_product_path(@product) %> |
<%= link_to 'Back', products_path %>
